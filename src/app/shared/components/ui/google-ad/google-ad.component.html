<!-- Google Ad Container -->
<div
  class="google-ad-wrapper"
  [style.min-height]="
    isAdLoaded
      ? 'auto'
      : hasAdvertisingConsent && !adLoadError
        ? '100px'
        : minHeight
  "
  [style.transition]="'min-height 0.3s ease'"
>
  <!-- Ad Blocker Detected State -->
  <div
    *ngIf="hasAdvertisingConsent && isAdBlockerDetected"
    class="content-notice ad-blocker"
    [style.min-height]="minHeight"
  >
    <div class="placeholder-content">
      <mat-icon class="placeholder-icon">block</mat-icon>
      <h4 class="placeholder-title">
        {{ 'google_ad.ad_blocker.title' | translate }}
      </h4>
      <p class="placeholder-description">
        {{ 'google_ad.ad_blocker.description' | translate }}
      </p>

      <p class="ad-blocker-request">
        {{ 'google_ad.ad_blocker.request' | translate }}
      </p>
    </div>
  </div>

  <!-- No Consent State -->
  <div
    *ngIf="!hasAdvertisingConsent && !isAdBlockerDetected"
    class="ad-placeholder no-consent"
    [style.min-height]="minHeight"
  >
    <div class="placeholder-content">
      <mat-icon class="placeholder-icon">block</mat-icon>
      <h4 class="placeholder-title">
        {{ 'google_ad.no_consent.title' | translate }}
      </h4>
      <p class="placeholder-description">
        {{ 'google_ad.no_consent.description' | translate }}
      </p>
      <button
        mat-raised-button
        color="primary"
        (click)="openConsentSettings()"
        class="consent-button"
      >
        <mat-icon>settings</mat-icon>
        {{ 'google_ad.no_consent.enable_ads' | translate }}
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div
    *ngIf="
      hasAdvertisingConsent &&
      !isAdBlockerDetected &&
      isAdLoading &&
      !adLoadError
    "
    class="content-notice loading"
    [style.min-height]="minHeight"
  >
    <div class="placeholder-content">
      <div class="loading-spinner">
        <mat-icon class="spinning">refresh</mat-icon>
      </div>
      <h4 class="placeholder-title">
        {{ 'google_ad.loading.title' | translate }}
      </h4>
      <p class="placeholder-description">
        {{ 'google_ad.loading.description' | translate }}
      </p>
    </div>
  </div>

  <!-- Error State -->
  <div
    *ngIf="hasAdvertisingConsent && !isAdBlockerDetected && adLoadError"
    class="content-notice error"
    [style.min-height]="minHeight"
  >
    <div class="placeholder-content">
      <mat-icon class="placeholder-icon error-icon">error_outline</mat-icon>
      <p class="placeholder-description">
        {{ 'google_ad.error.description' | translate }}
      </p>
    </div>
  </div>

  <!-- Actual Ad Container -->
  <div
    #adContainer
    *ngIf="hasAdvertisingConsent && !isAdBlockerDetected && !adLoadError && !isAdLoading"
    class="ad-container"
    [class.ad-loaded]="isAdLoaded"
    [style.min-height]="isAdLoaded ? 'auto' : minHeight"
  >
    <ins
      class="adsbygoogle"
      [style.display]="'block'"
      [style.min-height]="
        isAdLoaded ? 'auto' : isAdLoading ? '100px' : minHeight
      "
      [attr.data-ad-client]="'ca-pub-2064593657160416'"
      [attr.data-ad-slot]="adSlot"
      [attr.data-ad-format]="adFormat"
      [attr.data-ad-layout]="adLayout"
      [attr.data-ad-layout-key]="adLayoutKey"
      [attr.data-full-width-responsive]="fullWidthResponsive"
    ></ins>
  </div>
</div>
